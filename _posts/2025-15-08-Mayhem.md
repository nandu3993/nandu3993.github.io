---
title: TryHackMe Mayhem  
date: 2025-08-15  
tags: [tryhackme, ctf]  
author: nandakishor  
---

# Mayhem
### <img src="../assets/images/mayhem/618b3fa52f0acc0061fb0172-1721060635062.png" alt="Mayhem Screenshot" width="300">
Beneath the tempest’s roar, a quiet grace,  
Mayhem’s beauty hides in an unexpected place.  
Within the chaos, a paradox unfolds—  
A story of beauty that disorder molds.

## Initial Investigation

To begin, I opened the provided pcap file in Wireshark to examine its contents.

![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 115933.png>)

The analysis revealed that a PowerShell command was executed, downloading a file named `notepad.exe`. This action initiated a command and control (C2) connection with a remote server.

![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 120912.png>)

While it’s possible to directly access and download these files, that doesn’t always yield all the necessary information.

### Details of Network Requests

- **GET /install.ps1:**  
  The client, likely via PowerShell’s HTTP capabilities, requested a script file called `install.ps1` from server `10.0.2.37` on port `1337`.  
- The user (or attacker) downloaded `install.ps1` from a Python SimpleHTTPServer instance.  
- The script is designed to automatically fetch `notepad.exe` from the same server and save it locally.  
- Lastly, it executes the downloaded executable.

![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 122540.png>)

## Analysis Using Havoc C2 Parser

Further inspection shows the code is related to **Havoc C2**. To decode and fully understand the network traffic, I leveraged a Python parser.

I used the file below, making minor modifications to suit my needs:  

[Havoc C2 Pcap Parser](https://github.com/Immersive-Labs-Sec/HavocC2-Forensics/blob/main/PacketCapture/havoc-pcap-parser.py)


![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124540.png>)


we can answer all the questions from this code

![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124554.png>)

![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124650.png>)
 ![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124716.png>) 
![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124750.png>)
![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124857.png>) 
![alt text](<../assets/images/mayhem/Screenshot 2025-08-15 124920.png>)
